Molecular feature and sample information was parsed from the file 'case1_quant_full.csv' in the format 'mzmine3' with 'positive' ion mode polarity.
MS/MS fragmentation information was parsed from the file 'case1.mgf' in the format 'mgf'. MS/MS fragments +- 10 mass units around precursor m/z were removed.
Phenotype/bioactivity information was parsed from the file 'case1_phenotype.csv' in the format 'quantitative-percentage'.
MS2Query results were parsed from the file 'case1_ms2query.csv'. Only results with a score above a user-specified value of '0.7' were retained.
Molecular features were filtered and only retained if they were inside the relative intensity(height) range of '0.0-1.0' in at least one sample (relative to the feature with the highest intensity(height) in the sample).
Molecular features were filtered and only retained if they were inside the relative area range of '0.01-1.0' in at least one sample (relative to the feature with the highest area in the sample).
For each sample, overlapping molecular features were annotated for ion adducts using a cutoff mass deviation value of '15.0' ppm.
MS/MS spectra of all molecular features with more than '12' fragment ions were compared pairwise and scored using the 'modified cosine' algorithm, with a fragment tolerance of '0.1'. From the resulting similarity matrix, a network was created, with features represented as nodes and the similarity value as edges. Edges were pruned if their score was below a similarity cutoff of '0.7'. Also, edges were pruned so that only the '10' highest scoring edges remained.
MS/MS spectra of all molecular features with more than '12' fragment ions were compared pairwise and scored using the 'MS2Deepscore' algorithm. From the resulting similarity matrix, a network was created, with features represented as nodes and the similarity value as edges. Edges were pruned if their score was below a similarity cutoff of '0.8'. Also, edges were pruned so that only the '10' highest scoring edges remained.
For each molecular feature detected in more than two phenotype-associated samples, the 'mean' 'area' was correlated with the percentage activity per sample using 'pearson' correlation and the feature was only considered phenotype-associated if its coefficient was greater than '0.8' and its fdr_bh-corrected p-value less than '0.05'.